# Victor UI/UX Implementation Issues
# Generated: 2025-12-27
# Updated: 2025-12-28
# Purpose: Drive Claude Code implementation of UI improvements
# Reference: UI-UX-IMPROVEMENT-PLAN.md

# =============================================================================
# STATUS TRACKING
# =============================================================================
status_summary:
  last_updated: 2025-12-28
  session_notes: |
    Session 2025-12-28: Completed UI-008 (status bar) and UI-009 (toolbar redesign).
    - EditorStatusBar: word count, char count, cursor line/column
    - Toolbar: grouped controls with separators, heading dropdown H1-H6
    - Fixed heading replacement to modify in-place instead of prepending
    Next up: Stage 3 (Navigation Improvements) starting with UI-010 (Breadcrumbs)
  stages:
    stage-1:
      name: Tab-Based Layout Foundation
      status: COMPLETE
      issues:
        UI-001: COMPLETE  # EditorLayoutMode enum
        UI-002: COMPLETE  # TabBarView component
        UI-003: COMPLETE  # ContentView refactor
        UI-004: COMPLETE  # Keyboard shortcuts (Cmd+1/2/3)
        UI-005: COMPLETE  # Preview updates in all modes
    stage-2:
      name: Editor Enhancements
      status: COMPLETE
      issues:
        UI-006: REMOVED   # Line numbers - user decided against this feature
        UI-007: COMPLETE  # Current line highlighting
        UI-008: COMPLETE  # Word/character count status bar
        UI-009: COMPLETE  # Toolbar redesign (includes heading replacement fix)
    stage-3:
      name: Navigation Improvements
      status: PENDING
      issues:
        UI-010: PENDING   # Breadcrumb navigation
        UI-011: PENDING   # Quick Open (Cmd+P)
        UI-012: PENDING   # File status indicators
    stage-4:
      name: Inspector Panel
      status: PENDING
      issues:
        UI-013: PENDING   # Inspector infrastructure
        UI-014: PENDING   # Frontmatter in inspector
        UI-015: PENDING   # Preference for location
    stage-5:
      name: Focus Mode and Polish
      status: PENDING
      issues:
        UI-016: PENDING   # Focus Mode
        UI-017: PENDING   # Context menus
        UI-018: PENDING   # Preferences window
        UI-019: PENDING   # Empty state improvements
        UI-020: PENDING   # Animations

project:
  name: Victor
  description: macOS Hugo CMS - UI/UX Enhancement Implementation
  base_path: /Users/karan/Developer/macos/victor
  build_command: xcodebuild -project Victor.xcodeproj -scheme Victor -configuration Debug build

# =============================================================================
# STAGE 1: TAB-BASED LAYOUT FOUNDATION
# =============================================================================
# This is the foundational change that restructures the main content area
# to support Editor, Preview, and Split tabs. Must be completed first.

stages:
  - id: stage-1
    name: Tab-Based Layout Foundation
    description: |
      Replace the fixed editor+preview split with a tab-based system.
      Three tabs: Editor (full width), Preview (full width), Split (side-by-side).
      This is the foundation for all subsequent UI improvements.

    issues:
      - id: UI-001
        title: Create EditorLayoutMode enum and state management
        status: COMPLETE
        completed_date: 2025-12-27
        priority: critical
        estimated_effort: small
        dependencies: []
        description: |
          Add an enum to represent the three layout modes and integrate it into
          SiteViewModel for persistence. This state will control which view is
          shown in the main content area.

        technical_details:
          enum_definition: |
            enum EditorLayoutMode: String, CaseIterable {
                case editor   // Full-width editor only
                case preview  // Full-width preview only
                case split    // Side-by-side editor and preview (current behavior)
            }

          state_location: SiteViewModel
          persistence: UserDefaults with key "editorLayoutMode"
          default_value: .split (maintains current behavior for existing users)

        files_to_modify:
          - path: Victor/ViewModels/SiteViewModel.swift
            changes:
              - Add EditorLayoutMode enum at top of file
              - Add @Published var layoutMode: EditorLayoutMode property
              - Add init code to load from UserDefaults
              - Add didSet to persist changes to UserDefaults

        acceptance_criteria:
          - EditorLayoutMode enum exists with three cases
          - SiteViewModel has layoutMode property
          - Layout mode persists across app launches
          - Default is .split for backwards compatibility

      - id: UI-002
        title: Create TabBarView component
        status: COMPLETE
        completed_date: 2025-12-27
        priority: critical
        estimated_effort: medium
        dependencies: [UI-001]
        description: |
          Create a segmented control / tab bar that allows switching between
          Editor, Preview, and Split modes. This should follow macOS design
          patterns using a segmented picker or custom tab buttons.

        technical_details:
          component_design: |
            TabBarView should be a horizontal bar containing:
            1. Three tab buttons: "Editor", "Preview", "Split"
            2. Active tab should have visual distinction (filled background)
            3. Keyboard shortcuts: Cmd+1 (Editor), Cmd+2 (Preview), Cmd+3 (Split)
            4. Smooth transition animation when switching

          styling:
            background: Color(nsColor: .controlBackgroundColor)
            active_tab: Accent color with rounded rect background
            inactive_tab: Secondary label color
            height: 32pt
            padding: 8pt horizontal, 4pt vertical
            corner_radius: 6pt for active indicator

          swiftui_approach: |
            Use Picker with .segmented style, or custom HStack with buttons.
            Prefer Picker for native feel:

            Picker("Layout", selection: $viewModel.layoutMode) {
                Text("Editor").tag(EditorLayoutMode.editor)
                Text("Preview").tag(EditorLayoutMode.preview)
                Text("Split").tag(EditorLayoutMode.split)
            }
            .pickerStyle(.segmented)

        files_to_create:
          - path: Victor/Views/MainWindow/TabBarView.swift
            template: |
              import SwiftUI

              struct TabBarView: View {
                  @Bindable var viewModel: SiteViewModel

                  var body: some View {
                      // Implementation here
                  }
              }

        files_to_modify:
          - path: Victor.xcodeproj/project.pbxproj
            changes:
              - Add TabBarView.swift to PBXBuildFile section
              - Add TabBarView.swift to PBXFileReference section
              - Add TabBarView.swift to appropriate PBXGroup
              - Add TabBarView.swift to PBXSourcesBuildPhase

        acceptance_criteria:
          - TabBarView displays three mode options
          - Clicking/tapping changes the layout mode
          - Active mode is visually distinct
          - Follows macOS native styling
          - Keyboard shortcuts Cmd+1/2/3 work

      - id: UI-003
        title: Refactor ContentView to use tab-based layout
        status: COMPLETE
        completed_date: 2025-12-27
        priority: critical
        estimated_effort: medium
        dependencies: [UI-001, UI-002]
        description: |
          Modify ContentView to conditionally show Editor, Preview, or Split
          based on the current layoutMode. The TabBarView should appear above
          the content area, below the toolbar.

        technical_details:
          layout_structure: |
            NavigationSplitView {
                SidebarView(...)
            } detail: {
                VStack(spacing: 0) {
                    TabBarView(viewModel: viewModel)
                    Divider()

                    // Conditional content based on layoutMode
                    switch viewModel.layoutMode {
                    case .editor:
                        EditorPanelView(...)
                    case .preview:
                        PreviewPanel(...)
                    case .split:
                        HSplitView {
                            EditorPanelView(...)
                            PreviewPanel(...)
                        }
                    }
                }
            }

          animation: |
            Use withAnimation(.easeInOut(duration: 0.2)) when switching modes
            Content should crossfade smoothly

          considerations:
            - EditorPanelView needs to work standalone (already does)
            - PreviewPanel needs to work standalone (verify)
            - Split mode should use HSplitView or HStack with fixed ratio
            - Preserve editor state when switching modes

        files_to_modify:
          - path: Victor/Views/MainWindow/ContentView.swift
            changes:
              - Add TabBarView above content area
              - Replace fixed HSplitView with conditional layout
              - Add animation for mode transitions
              - Ensure editor state preserved across mode changes

        acceptance_criteria:
          - TabBarView appears below toolbar, above content
          - Editor mode shows full-width editor
          - Preview mode shows full-width preview
          - Split mode shows side-by-side (current behavior)
          - Switching modes is animated
          - Editor content is not lost when switching modes
          - Preview updates correctly in all modes

      - id: UI-004
        title: Add keyboard shortcuts for layout modes
        status: COMPLETE
        completed_date: 2025-12-27
        priority: high
        estimated_effort: small
        dependencies: [UI-003]
        description: |
          Add Cmd+1, Cmd+2, Cmd+3 keyboard shortcuts to switch between
          Editor, Preview, and Split modes respectively.

        technical_details:
          implementation: |
            Add .keyboardShortcut modifiers or use Commands in App struct.

            Option A - In TabBarView:
            Button("Editor") { viewModel.layoutMode = .editor }
                .keyboardShortcut("1", modifiers: .command)

            Option B - In VictorApp Commands:
            CommandGroup(after: .toolbar) {
                Button("Editor") { ... }
                    .keyboardShortcut("1", modifiers: .command)
                // etc.
            }

          menu_integration: |
            Add to View menu:
            View
            â”œâ”€ Editor Mode      âŒ˜1
            â”œâ”€ Preview Mode     âŒ˜2
            â”œâ”€ Split Mode       âŒ˜3

        files_to_modify:
          - path: Victor/VictorApp.swift
            changes:
              - Add CommandGroup for View menu with layout shortcuts
          - path: Victor/Views/MainWindow/TabBarView.swift
            changes:
              - Ensure shortcuts work via .keyboardShortcut if not using Commands

        acceptance_criteria:
          - Cmd+1 switches to Editor mode
          - Cmd+2 switches to Preview mode
          - Cmd+3 switches to Split mode
          - View menu shows these options with shortcuts

      - id: UI-005
        title: Ensure preview updates in all layout modes
        status: COMPLETE
        completed_date: 2025-12-27
        priority: high
        estimated_effort: small
        dependencies: [UI-003]
        description: |
          Verify that live preview works correctly when in Preview-only mode
          and Split mode. The preview should update based on editor changes
          even when the editor is not visible.

        technical_details:
          current_behavior: |
            Preview updates based on SiteViewModel.currentEditingContent
            which is updated by EditorViewModel on text changes.

          required_behavior: |
            - In Split mode: Preview updates as user types (current)
            - In Preview mode: Preview shows current content, updates if
              content was changed in Editor mode
            - In Editor mode: Preview state is maintained for when user
              switches back

          edge_cases:
            - Switching from Editor to Preview should show latest content
            - File selection while in Preview mode should update preview
            - Auto-save should work regardless of visible mode

        files_to_modify:
          - path: Victor/Views/MainWindow/PreviewPanel.swift
            changes:
              - Verify it reads from correct source
              - Ensure it updates on file selection changes
          - path: Victor/ViewModels/EditorViewModel.swift
            changes:
              - Ensure content sync works regardless of layout mode

        acceptance_criteria:
          - Preview shows correct content in all three modes
          - Editing in Editor mode, then switching to Preview shows changes
          - Selecting a new file updates preview in Preview mode
          - No stale content is ever displayed

# =============================================================================
# STAGE 2: EDITOR ENHANCEMENTS
# =============================================================================
# Improve the editing experience with line numbers, current line highlighting,
# word count, and improved toolbar.

  - id: stage-2
    name: Editor Enhancements
    description: |
      Enhance the editor with professional features: line numbers, current
      line highlighting, word/character count, and an improved toolbar.

    issues:
      - id: UI-006
        title: Add line number gutter to editor
        status: REMOVED
        removed_date: 2025-12-28
        removal_reason: User decided against this feature - caused visual issues with editor appearance
        priority: medium
        estimated_effort: large
        dependencies: [UI-003]
        description: |
          Add an optional line number gutter on the left side of the editor,
          similar to Xcode. Line numbers should scroll with content and
          highlight the current line number.

        technical_details:
          implementation_approach: |
            Use NSRulerView attached to NSScrollView's vertical ruler.
            This is the standard AppKit approach for line numbers.

            Steps:
            1. Create LineNumberRulerView subclass of NSRulerView
            2. Calculate line numbers based on text layout
            3. Draw numbers aligned with text lines
            4. Highlight current line number
            5. Attach ruler to scroll view in EditorTextView

          class_structure: |
            class LineNumberRulerView: NSRulerView {
                weak var textView: NSTextView?

                override func drawHashMarksAndLabels(in rect: NSRect) {
                    // Calculate visible lines
                    // Draw line numbers right-aligned
                    // Highlight current line
                }
            }

          styling:
            font: 11pt system monospace
            color: NSColor.secondaryLabelColor
            current_line_color: NSColor.labelColor
            background: NSColor.controlBackgroundColor (subtle)
            width: 40pt (adjusts for large line counts)
            padding: 8pt right margin

          toggle_preference:
            key: "showLineNumbers"
            default: true
            location: View menu "Show Line Numbers"

        files_to_create:
          - path: Victor/Views/Editor/LineNumberRulerView.swift
            description: NSRulerView subclass for line numbers

        files_to_modify:
          - path: Victor/Views/Editor/EditorTextView.swift
            changes:
              - Attach LineNumberRulerView to scroll view
              - Add showLineNumbers preference binding
              - Update ruler on text changes and selection changes
          - path: Victor/ViewModels/SiteViewModel.swift
            changes:
              - Add showLineNumbers preference property
          - path: Victor.xcodeproj/project.pbxproj
            changes:
              - Add LineNumberRulerView.swift to project

        acceptance_criteria:
          - Line numbers appear in left gutter
          - Numbers align with corresponding text lines
          - Current line number is highlighted
          - Numbers scroll with content
          - Can be toggled on/off via View menu
          - Performance is smooth for large files (1000+ lines)

      - id: UI-007
        title: Add current line highlighting
        status: COMPLETE
        completed_date: 2025-12-28
        priority: medium
        estimated_effort: medium
        dependencies: [UI-003]
        description: |
          Highlight the current line (where cursor is) with a subtle
          background color for better focus and orientation.

        technical_details:
          implementation: |
            Override drawBackground(in:) in custom NSTextView subclass.
            Calculate the rect for the current line and fill with subtle color.

            1. Get cursor position from selectedRange
            2. Calculate line rect using layoutManager
            3. Draw filled rect behind text with low opacity accent

          code_snippet: |
            override func drawBackground(in rect: NSRect) {
                super.drawBackground(in: rect)

                guard let layoutManager = layoutManager,
                      let textContainer = textContainer else { return }

                let cursorPosition = selectedRange().location
                let glyphRange = layoutManager.glyphRange(
                    forCharacterRange: NSRange(location: cursorPosition, length: 0),
                    actualCharacterRange: nil
                )
                var lineRect = layoutManager.lineFragmentRect(
                    forGlyphAt: glyphRange.location,
                    effectiveRange: nil
                )
                lineRect.origin.x = 0
                lineRect.size.width = bounds.width

                NSColor.accentColor.withAlphaComponent(0.08).setFill()
                lineRect.fill()
            }

          styling:
            color: Accent color at 8% opacity (subtle)
            full_width: true (extends to edges)

          toggle_preference:
            key: "highlightCurrentLine"
            default: true

        files_to_modify:
          - path: Victor/Views/Editor/EditorTextView.swift
            changes:
              - Create custom NSTextView subclass if not already
              - Override drawBackground to draw line highlight
              - Trigger redraw on selection change
          - path: Victor/ViewModels/SiteViewModel.swift
            changes:
              - Add highlightCurrentLine preference property

        acceptance_criteria:
          - Current line has subtle background highlight
          - Highlight moves as cursor moves
          - Works with line wrapping (highlights visual line)
          - Can be toggled on/off
          - Does not impact typing performance

      - id: UI-008
        title: Add word and character count status bar
        status: COMPLETE
        completed_date: 2025-12-28
        priority: medium
        estimated_effort: small
        dependencies: [UI-003]
        description: |
          Add a status bar at the bottom of the editor showing word count,
          character count, and cursor position (line and column).

        technical_details:
          layout: |
            Horizontal bar below editor, above frontmatter panel:

            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  234 words  â€¢  1,456 characters  â€¢  Line 42, Col 15         â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

          content:
            - Word count (split by whitespace, filtered)
            - Character count (total length)
            - Line number (1-based)
            - Column number (1-based, position in current line)
            - Optional: Reading time estimate (words / 200)

          styling:
            height: 24pt
            background: Color(nsColor: .windowBackgroundColor)
            text: Secondary label color, 11pt system font
            separator: " â€¢ " between items
            alignment: Leading (left)

          performance: |
            Calculate counts on text change with debounce (100ms).
            Cursor position updates immediately on selection change.

        files_to_create:
          - path: Victor/Views/Editor/EditorStatusBar.swift
            description: Status bar view showing document statistics

        files_to_modify:
          - path: Victor/Views/MainWindow/EditorPanelView.swift
            changes:
              - Add EditorStatusBar below EditorTextView
              - Pass required bindings (text, selection)
          - path: Victor/ViewModels/EditorViewModel.swift
            changes:
              - Add computed properties for word/char count
              - Add cursor position tracking (line, column)
          - path: Victor.xcodeproj/project.pbxproj
            changes:
              - Add EditorStatusBar.swift to project

        acceptance_criteria:
          - Status bar shows word count
          - Status bar shows character count
          - Status bar shows current line number
          - Status bar shows current column number
          - Counts update as user types (debounced)
          - Cursor position updates immediately

      - id: UI-009
        title: Redesign editor toolbar with grouped controls
        status: COMPLETE
        completed_date: 2025-12-28
        priority: medium
        estimated_effort: medium
        dependencies: [UI-003]
        description: |
          Improve the editor toolbar by grouping related controls with
          visual separators. Add heading level dropdown. Improve iconography.

        technical_details:
          current_layout: |
            [B] [I] [H] [â€¢] [1.] [</>] [ğŸ”—] [ğŸ–¼] [â]   [ğŸ‘] [ğŸ’¾]

          proposed_layout: |
            [B] [I] â”‚ [Hâ–¾] â”‚ [â€¢] [1.] â”‚ [</>] [â] â”‚ [ğŸ”—] [ğŸ–¼]  â•‘  [ğŸ’¾]
            â”€â”€â”€â”€â”€â”€â”€ â”‚ â”€â”€â”€â”€ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€  â•‘  â”€â”€â”€â”€â”€
             Text   â”‚ Head â”‚  Lists   â”‚   Code     â”‚  Insert   â•‘  Save

          grouping:
            - group1: [Bold, Italic] - Text formatting
            - group2: [Heading dropdown H1-H6] - Structure
            - group3: [Bullet list, Numbered list] - Lists
            - group4: [Code block, Block quote] - Block elements
            - group5: [Link, Image] - Insert elements
            - separator: Visual divider (thicker)
            - group6: [Save button] - Actions

          heading_dropdown: |
            Menu {
                Button("Heading 1") { insertHeading(1) }
                Button("Heading 2") { insertHeading(2) }
                ...
                Button("Heading 6") { insertHeading(6) }
            } label: {
                Label("Heading", systemImage: "h.square")
            }

          styling:
            group_separator: Divider() with 8pt horizontal padding
            action_separator: Thicker divider or different background
            icons: SF Symbols only for consistency
            tooltips: Show keyboard shortcut in tooltip

        files_to_modify:
          - path: Victor/Views/MainWindow/EditorPanelView.swift
            changes:
              - Reorganize toolbar buttons into groups
              - Add Divider() between groups
              - Replace heading button with dropdown menu
              - Add tooltips with keyboard shortcuts
              - Improve visual hierarchy

        acceptance_criteria:
          - Toolbar buttons are logically grouped
          - Groups have visual separators
          - Heading is a dropdown with H1-H6 options
          - All buttons have tooltips showing shortcuts
          - Save button is visually separated from formatting

# =============================================================================
# STAGE 3: NAVIGATION IMPROVEMENTS
# =============================================================================
# Add breadcrumb navigation, quick open, and file status indicators.

  - id: stage-3
    name: Navigation Improvements
    description: |
      Improve file navigation with breadcrumbs, quick open dialog,
      and visual status indicators in the sidebar.

    issues:
      - id: UI-010
        title: Add breadcrumb navigation bar
        priority: medium
        estimated_effort: medium
        dependencies: [UI-003]
        description: |
          Show the current file path as clickable breadcrumbs above the
          editor. Each segment can be clicked to navigate to that folder.

        technical_details:
          layout: |
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ ğŸ“ content  â€º  posts  â€º  2025  â€º  hello.md                  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

          behavior:
            - Click folder segment: Navigate to that folder in sidebar
            - Click file segment: No action (already there)
            - Hover: Underline to indicate clickable
            - Click dropdown arrow: Show siblings in that folder

          implementation: |
            1. Parse selectedNode path into components
            2. Create button for each path component
            3. Add "â€º" (chevron.right) separator between
            4. Handle click to select folder in sidebar

          styling:
            height: 28pt
            background: transparent or subtle controlBackground
            text: 12pt system font
            icon: folder.fill for folders, doc.text for file
            separator: "â€º" or SF Symbol chevron.right
            hover: Underline text

        files_to_create:
          - path: Victor/Views/MainWindow/BreadcrumbBar.swift
            description: Breadcrumb navigation component

        files_to_modify:
          - path: Victor/Views/MainWindow/EditorPanelView.swift
            changes:
              - Add BreadcrumbBar above editor toolbar
          - path: Victor.xcodeproj/project.pbxproj
            changes:
              - Add BreadcrumbBar.swift to project

        acceptance_criteria:
          - Breadcrumb bar shows current file path
          - Each folder segment is clickable
          - Clicking folder navigates sidebar to that folder
          - Path updates when selecting different files
          - Styling matches macOS conventions

      - id: UI-011
        title: Implement Quick Open dialog (Cmd+P)
        priority: high
        estimated_effort: large
        dependencies: [UI-003]
        description: |
          Add VS Code-style quick open dialog for fuzzy file search.
          Press Cmd+P to open, type to filter, Enter to open file.

        technical_details:
          layout: |
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  ğŸ” hello                                                [Ã—] â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚  ğŸ“„ content/posts/hello.md                      â˜… (recent)   â”‚
            â”‚  ğŸ“„ content/projects/hello-world/index.md                    â”‚
            â”‚  ğŸ“„ content/drafts/hello-again.md                            â”‚
            â”‚  ğŸ“„ themes/mytheme/layouts/hello.html                        â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

          behavior:
            - Cmd+P opens overlay modal
            - Type to filter files (fuzzy match)
            - Arrow keys navigate results
            - Enter opens selected file
            - Esc closes dialog
            - Recent files shown when empty

          fuzzy_matching: |
            Match characters in order but not necessarily adjacent.
            "hlmd" matches "hello.md" and "help-readme.md"

            Score based on:
            - Consecutive character matches (higher)
            - Match at word boundaries (higher)
            - Match at start of filename (higher)
            - Shorter paths preferred

          implementation:
            - Create QuickOpenView as overlay
            - Build file index on site load
            - Implement fuzzy match algorithm
            - Track recent files in UserDefaults
            - Animate appearance (fade + slide down)

          styling:
            width: 500pt (centered)
            max_height: 400pt
            background: .ultraThinMaterial or vibrant
            corner_radius: 12pt
            shadow: Large drop shadow
            result_row_height: 32pt
            highlight: Accent color background for selected

        files_to_create:
          - path: Victor/Views/QuickOpen/QuickOpenView.swift
            description: Quick open overlay view
          - path: Victor/Views/QuickOpen/QuickOpenResultRow.swift
            description: Individual result row
          - path: Victor/Services/FuzzyMatcher.swift
            description: Fuzzy matching algorithm

        files_to_modify:
          - path: Victor/ViewModels/SiteViewModel.swift
            changes:
              - Add isQuickOpenVisible state
              - Add fileIndex for quick search
              - Add recentFiles tracking
              - Add method to build file index on site load
          - path: Victor/Views/MainWindow/ContentView.swift
            changes:
              - Add QuickOpenView overlay
              - Add Cmd+P keyboard shortcut
          - path: Victor.xcodeproj/project.pbxproj
            changes:
              - Add new files to project

        acceptance_criteria:
          - Cmd+P opens quick open dialog
          - Typing filters files with fuzzy matching
          - Arrow keys navigate results
          - Enter opens selected file
          - Esc closes dialog
          - Recent files shown when search is empty
          - Performance is fast (< 50ms for 500 files)

      - id: UI-012
        title: Add file status indicators to sidebar
        priority: medium
        estimated_effort: small
        dependencies: [UI-003]
        description: |
          Show visual indicators in the sidebar for file states:
          unsaved changes, recently saved, external modification.

        technical_details:
          indicators:
            - unsaved: Orange dot (â—) - file has unsaved changes
            - saved: Green checkmark (âœ“) - recently saved (fade after 3s)
            - conflict: Yellow warning (âš ï¸) - external modification detected

          layout: |
            ğŸ“ content/
             â”œâ”€ posts/
             â”‚  â”œâ”€ hello.md      â—  (modified, unsaved)
             â”‚  â”œâ”€ world.md      âœ“  (just saved)
             â”‚  â””â”€ draft.md      âš ï¸  (conflict)
             â””â”€ about.md

          implementation: |
            Add computed property to FileNode or track in SiteViewModel.
            Overlay indicator on right side of file row.

          colors:
            unsaved: .orange
            saved: .green (with fade animation)
            conflict: .yellow

        files_to_modify:
          - path: Victor/Views/MainWindow/FileListView.swift
            changes:
              - Add indicator overlay to FileRowView
              - Show appropriate indicator based on file state
          - path: Victor/ViewModels/SiteViewModel.swift
            changes:
              - Track modified files set
              - Track recently saved files with timestamps
          - path: Victor/ViewModels/EditorViewModel.swift
            changes:
              - Notify SiteViewModel of save events

        acceptance_criteria:
          - Unsaved files show orange dot
          - Just-saved files show green checkmark (fades after 3s)
          - Conflicting files show yellow warning
          - Indicators don't interfere with file selection

# =============================================================================
# STAGE 4: INSPECTOR PANEL
# =============================================================================
# Add right-side inspector panel as alternative to bottom frontmatter panel.

  - id: stage-4
    name: Inspector Panel
    description: |
      Add a right-side inspector panel for metadata editing, following
      the macOS pattern used in Xcode, Finder, and Pages.

    issues:
      - id: UI-013
        title: Create Inspector panel infrastructure
        priority: medium
        estimated_effort: medium
        dependencies: [UI-003]
        description: |
          Add a collapsible right sidebar (inspector) that can show
          file metadata, document statistics, and other contextual info.

        technical_details:
          layout_options: |
            Option A: Use NavigationSplitView with three columns
            Option B: Add trailing HSplitView for inspector
            Option C: Overlay panel that slides in

            Recommendation: Option B for flexibility

          structure: |
            NavigationSplitView {
                Sidebar
            } detail: {
                HSplitView {
                    // Main content (tabs + editor/preview)
                    VStack {
                        TabBarView
                        EditorOrPreview
                    }

                    // Inspector (when visible)
                    if viewModel.isInspectorVisible {
                        InspectorPanel(...)
                            .frame(width: 260)
                    }
                }
            }

          toggle:
            shortcut: Opt+Cmd+I (standard inspector shortcut)
            menu: View > Show/Hide Inspector
            toolbar: Inspector button

          styling:
            width: 260pt (fixed or user-resizable)
            background: .windowBackgroundColor
            divider: Standard macOS divider

        files_to_create:
          - path: Victor/Views/Inspector/InspectorPanel.swift
            description: Main inspector panel container

        files_to_modify:
          - path: Victor/ViewModels/SiteViewModel.swift
            changes:
              - Add isInspectorVisible state (persisted)
          - path: Victor/Views/MainWindow/ContentView.swift
            changes:
              - Wrap detail content in HSplitView
              - Add InspectorPanel conditionally
              - Add Opt+Cmd+I keyboard shortcut
          - path: Victor.xcodeproj/project.pbxproj
            changes:
              - Add InspectorPanel.swift to project

        acceptance_criteria:
          - Inspector panel appears on right side
          - Can toggle with Opt+Cmd+I
          - Toggle from View menu
          - State persists across app launches
          - Smooth show/hide animation

      - id: UI-014
        title: Move frontmatter editing to Inspector
        priority: medium
        estimated_effort: medium
        dependencies: [UI-013]
        description: |
          Add frontmatter editing capabilities to the inspector panel,
          mirroring the existing FrontmatterEditorView functionality.

        technical_details:
          inspector_sections: |
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   ğŸ“‹ Metadata           â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚ Title                   â”‚
            â”‚ [Hello World         ]  â”‚
            â”‚                         â”‚
            â”‚ Date                    â”‚
            â”‚ [2025-01-15         ğŸ“…] â”‚
            â”‚                         â”‚
            â”‚ Draft [ ]               â”‚
            â”‚                         â”‚
            â”‚ Tags                    â”‚
            â”‚ [hugo] [blog] [+]       â”‚
            â”‚                         â”‚
            â”‚ Categories              â”‚
            â”‚ [tutorials] [+]         â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚   ğŸ“Š Statistics         â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚ Words: 234              â”‚
            â”‚ Characters: 1,456       â”‚
            â”‚ Reading time: ~1 min    â”‚
            â”‚ Created: Jan 15, 2025   â”‚
            â”‚ Modified: Jan 20, 2025  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

          reuse_components: |
            Reuse existing components from FrontmatterEditorView:
            - FormFieldView
            - TagInputView
            - TagChip
            - FlowLayout

          sections:
            - Metadata: Frontmatter fields
            - Statistics: Word count, reading time, dates
            - (Future) History: Recent edits

        files_to_create:
          - path: Victor/Views/Inspector/MetadataSection.swift
            description: Frontmatter fields in inspector
          - path: Victor/Views/Inspector/StatisticsSection.swift
            description: Document statistics in inspector

        files_to_modify:
          - path: Victor/Views/Inspector/InspectorPanel.swift
            changes:
              - Add collapsible sections
              - Include MetadataSection
              - Include StatisticsSection
          - path: Victor.xcodeproj/project.pbxproj
            changes:
              - Add new section files to project

        acceptance_criteria:
          - Frontmatter fields editable in inspector
          - Statistics section shows word/char count
          - Sections are collapsible
          - Changes sync with editor content
          - Both bottom panel and inspector can coexist (user choice)

      - id: UI-015
        title: Add user preference for frontmatter location
        priority: low
        estimated_effort: small
        dependencies: [UI-014]
        description: |
          Allow users to choose where frontmatter editing appears:
          bottom panel (current), inspector (new), or both.

        technical_details:
          preference:
            key: "frontmatterPosition"
            options: ["bottom", "inspector", "both"]
            default: "bottom" (current behavior)
            location: Preferences window or View menu

          behavior:
            - bottom: Show FrontmatterBottomPanel only
            - inspector: Show in InspectorPanel only
            - both: Show in both locations (synced)

        files_to_modify:
          - path: Victor/ViewModels/SiteViewModel.swift
            changes:
              - Add frontmatterPosition preference
          - path: Victor/Views/MainWindow/EditorPanelView.swift
            changes:
              - Conditionally show bottom panel based on preference
          - path: Victor/Views/Inspector/InspectorPanel.swift
            changes:
              - Conditionally show metadata section based on preference

        acceptance_criteria:
          - User can choose frontmatter location
          - Preference persists
          - All options work correctly

# =============================================================================
# STAGE 5: FOCUS MODE & POLISH
# =============================================================================
# Add focus/zen mode and various polish improvements.

  - id: stage-5
    name: Focus Mode and Polish
    description: |
      Add distraction-free focus mode and various polish improvements
      including better animations, context menus, and preferences.

    issues:
      - id: UI-016
        title: Implement Focus Mode
        priority: medium
        estimated_effort: large
        dependencies: [UI-003]
        description: |
          Add a distraction-free writing mode that hides all UI chrome
          and centers the text for focused writing.

        technical_details:
          appearance: |
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                                                              â”‚
            â”‚                                                              â”‚
            â”‚                   # My Blog Post                             â”‚
            â”‚                                                              â”‚
            â”‚                   This is focused writing.                   â”‚
            â”‚                   No distractions here.                      â”‚
            â”‚                                                              â”‚
            â”‚                                                              â”‚
            â”‚                                                 [7%]         â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

          behavior:
            - Enter: Ctrl+Cmd+F or View > Focus Mode
            - Exit: Esc key or move mouse to top
            - Hides: Sidebar, toolbar, tabs, preview, frontmatter, status bar
            - Shows: Editor only, centered, comfortable width
            - Auto-hide cursor after 3s of no movement
            - Show progress indicator (% through document)

          styling:
            max_width: 700pt (comfortable reading width)
            background: Slightly dimmed from normal
            text: Same as normal editor
            animation: Fade transition (0.3s)

          optional_features:
            - Typewriter mode: Keep current line vertically centered
            - Paragraph focus: Dim paragraphs except current one

          implementation: |
            Create FocusModeCover view that overlays entire window.
            Use .fullScreenCover or custom overlay.
            Pass editor binding for content editing.

        files_to_create:
          - path: Victor/Views/FocusMode/FocusModeView.swift
            description: Full-screen focus mode overlay

        files_to_modify:
          - path: Victor/ViewModels/SiteViewModel.swift
            changes:
              - Add isFocusModeActive state
          - path: Victor/Views/MainWindow/ContentView.swift
            changes:
              - Add focus mode overlay
              - Add Ctrl+Cmd+F keyboard shortcut
          - path: Victor/VictorApp.swift
            changes:
              - Add Focus Mode to View menu
          - path: Victor.xcodeproj/project.pbxproj
            changes:
              - Add FocusModeView.swift to project

        acceptance_criteria:
          - Ctrl+Cmd+F enters focus mode
          - All UI chrome is hidden
          - Text is centered with comfortable width
          - Esc exits focus mode
          - Content edits are preserved
          - Smooth enter/exit animation

      - id: UI-017
        title: Add rich context menus
        priority: low
        estimated_effort: medium
        dependencies: [UI-003]
        description: |
          Add comprehensive right-click context menus throughout the app
          for quick access to common actions.

        technical_details:
          editor_context_menu: |
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Cut                    âŒ˜X   â”‚
            â”‚ Copy                   âŒ˜C   â”‚
            â”‚ Paste                  âŒ˜V   â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚ Bold                   âŒ˜B   â”‚
            â”‚ Italic                 âŒ˜I   â”‚
            â”‚ Heading               â–¶     â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚ Insert Link           âŒ˜K   â”‚
            â”‚ Insert Image          âŒ˜â‡§I  â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚ Look Up "word"              â”‚
            â”‚ Search with Google          â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

          sidebar_context_menu: |
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Open                        â”‚
            â”‚ Open in New Tab             â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚ New File Here...            â”‚
            â”‚ New Folder...               â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚ Rename...               â   â”‚
            â”‚ Duplicate                   â”‚
            â”‚ Move to Trash          âŒ˜âŒ«   â”‚
            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚ Reveal in Finder            â”‚
            â”‚ Copy Path                   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

          implementation: |
            Use .contextMenu { } modifier in SwiftUI.
            For NSTextView, implement menu(for:) delegate method.

        files_to_modify:
          - path: Victor/Views/Editor/EditorTextView.swift
            changes:
              - Override menu(for:) to customize context menu
              - Add formatting and insert options
          - path: Victor/Views/MainWindow/FileListView.swift
            changes:
              - Expand existing context menu
              - Add rename, duplicate, delete, reveal options
          - path: Victor/Services/FileSystemService.swift
            changes:
              - Add methods for rename, duplicate, delete operations

        acceptance_criteria:
          - Editor has rich context menu with formatting
          - Sidebar files have comprehensive context menu
          - All menu actions work correctly
          - Keyboard shortcuts shown in menu

      - id: UI-018
        title: Add Preferences window
        priority: low
        estimated_effort: medium
        dependencies: [UI-006, UI-007]
        description: |
          Create a Preferences window (Cmd+,) for user-configurable
          settings like editor font, line numbers, etc.

        technical_details:
          layout: |
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                         Appearance                              â”‚
            â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
            â”‚                                                                 â”‚
            â”‚  Editor Font:    [SF Mono        â–¾]    Size: [14 â–¾]            â”‚
            â”‚                                                                 â”‚
            â”‚  Line Spacing:   â—‹ Compact  â— Normal  â—‹ Relaxed                â”‚
            â”‚                                                                 â”‚
            â”‚  Theme:          â—‹ System  â—‹ Light  â—‹ Dark                     â”‚
            â”‚                                                                 â”‚
            â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
            â”‚                         Editor                                  â”‚
            â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
            â”‚                                                                 â”‚
            â”‚  [âœ“] Show line numbers                                          â”‚
            â”‚  [âœ“] Highlight current line                                     â”‚
            â”‚  [ ] Show invisible characters                                  â”‚
            â”‚                                                                 â”‚
            â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
            â”‚                         Auto-Save                               â”‚
            â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
            â”‚                                                                 â”‚
            â”‚  [âœ“] Enable auto-save                                           â”‚
            â”‚  Auto-save delay: [2] seconds                                   â”‚
            â”‚                                                                 â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

          sections:
            - Appearance: Font, font size, line spacing, theme
            - Editor: Line numbers, current line, invisibles
            - Auto-Save: Enable, delay interval

          implementation: |
            Use Settings scene in SwiftUI App for macOS Ventura+.
            Or create custom Window for older macOS.

        files_to_create:
          - path: Victor/Views/Preferences/PreferencesView.swift
            description: Main preferences view
          - path: Victor/Views/Preferences/AppearancePreferences.swift
            description: Appearance settings section
          - path: Victor/Views/Preferences/EditorPreferences.swift
            description: Editor settings section

        files_to_modify:
          - path: Victor/VictorApp.swift
            changes:
              - Add Settings scene with PreferencesView
          - path: Victor/ViewModels/SiteViewModel.swift
            changes:
              - Centralize all preference properties
              - Ensure all are persisted to UserDefaults
          - path: Victor.xcodeproj/project.pbxproj
            changes:
              - Add preference view files to project

        acceptance_criteria:
          - Cmd+, opens Preferences window
          - All settings are functional
          - Settings persist across launches
          - Changes apply immediately (no restart needed)

      - id: UI-019
        title: Add empty state improvements
        priority: low
        estimated_effort: small
        dependencies: [UI-003]
        description: |
          Improve empty states with helpful illustrations and actions
          for better onboarding and user experience.

        technical_details:
          no_site_open: |
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                                                              â”‚
            â”‚                         ğŸ“                                   â”‚
            â”‚                                                              â”‚
            â”‚                   Open a Hugo Site                           â”‚
            â”‚                                                              â”‚
            â”‚              Drag a folder here or click to browse           â”‚
            â”‚                                                              â”‚
            â”‚                  [ Open Folder... ]                          â”‚
            â”‚                                                              â”‚
            â”‚              Recent:                                         â”‚
            â”‚              â€¢ ~/Sites/my-blog                               â”‚
            â”‚              â€¢ ~/Sites/portfolio                             â”‚
            â”‚                                                              â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

          no_file_selected: |
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                                                              â”‚
            â”‚                         ğŸ“                                   â”‚
            â”‚                                                              â”‚
            â”‚                   Select a file to edit                      â”‚
            â”‚                                                              â”‚
            â”‚              Choose a markdown file from the sidebar         â”‚
            â”‚              or press âŒ˜N to create a new post                â”‚
            â”‚              or press âŒ˜P to quick open                       â”‚
            â”‚                                                              â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

          styling:
            icon: Large SF Symbol (60pt)
            heading: 20pt semibold
            subtext: 14pt secondary color
            button: Prominent bordered style
            recent_list: Clickable list items

        files_to_modify:
          - path: Victor/Views/MainWindow/SidebarView.swift
            changes:
              - Enhance OpenFolderPrompt with recent sites
              - Add drag-and-drop support
          - path: Victor/Views/MainWindow/EditorPanelView.swift
            changes:
              - Improve no-file-selected state
              - Add helpful hints and keyboard shortcuts

        acceptance_criteria:
          - No-site state shows recent sites
          - No-file state shows helpful hints
          - Empty states are visually polished
          - Actions in empty states work correctly

      - id: UI-020
        title: Refine animations and transitions
        priority: low
        estimated_effort: small
        dependencies: [UI-003]
        description: |
          Add subtle, consistent animations throughout the app for
          a polished, responsive feel.

        technical_details:
          animations_to_add:
            - File selection: Fade in editor content (0.15s)
            - Mode switch: Crossfade between editor/preview (0.2s)
            - Inspector toggle: Slide in/out (0.2s)
            - Quick open: Fade + scale in (0.15s)
            - Save indicator: Pulse animation on checkmark
            - Error states: Subtle shake animation

          animation_guidelines:
            - Duration: 0.15-0.25s for most transitions
            - Easing: .easeInOut for smooth feel
            - Respect: "Reduce Motion" accessibility setting
            - Subtlety: Animations should enhance, not distract

          reduce_motion: |
            @Environment(\.accessibilityReduceMotion) var reduceMotion

            withAnimation(reduceMotion ? nil : .easeInOut(duration: 0.2)) {
                // State change
            }

        files_to_modify:
          - path: Victor/Views/MainWindow/ContentView.swift
            changes:
              - Add animation to layout mode changes
              - Add animation to inspector toggle
          - path: Victor/Views/MainWindow/EditorPanelView.swift
            changes:
              - Add animation to file loading
              - Add pulse animation to save indicator

        acceptance_criteria:
          - Layout mode changes are animated
          - Inspector slides in/out smoothly
          - Animations respect Reduce Motion setting
          - No jarring or distracting animations

# =============================================================================
# IMPLEMENTATION NOTES
# =============================================================================

implementation_notes:
  xcode_project_updates: |
    When creating new Swift files, ALWAYS update Victor.xcodeproj/project.pbxproj:
    1. Add to PBXBuildFile section (with unique ID)
    2. Add to PBXFileReference section (with unique ID)
    3. Add to appropriate PBXGroup (Views/MainWindow, Views/Editor, etc.)
    4. Add to PBXSourcesBuildPhase

    See XCODE-PROJECT-UPDATE-PROTOCOL.md for detailed instructions.

  testing_approach: |
    After each issue:
    1. Build: xcodebuild -project Victor.xcodeproj -scheme Victor build
    2. Run and manually test the feature
    3. Test edge cases (empty states, large files, rapid actions)
    4. Verify no regressions in existing functionality

  state_persistence: |
    New preferences to add to UserDefaults:
    - editorLayoutMode: String (editor, preview, split)
    - isInspectorVisible: Bool
    - showLineNumbers: Bool
    - highlightCurrentLine: Bool
    - frontmatterPosition: String (bottom, inspector, both)
    - recentFiles: [String]

    Initialize with sensible defaults in SiteViewModel.init()

  keyboard_shortcuts: |
    New shortcuts being added:
    - Cmd+1: Editor mode
    - Cmd+2: Preview mode
    - Cmd+3: Split mode
    - Cmd+P: Quick Open
    - Opt+Cmd+I: Toggle Inspector
    - Ctrl+Cmd+F: Focus Mode

    Add to VictorApp Commands and ensure no conflicts.

  accessibility: |
    For each new UI element:
    - Add accessibilityLabel
    - Add accessibilityHint where helpful
    - Ensure keyboard navigation works
    - Test with VoiceOver
    - Respect Reduce Motion preference

# =============================================================================
# DEPENDENCY GRAPH
# =============================================================================

dependency_graph: |
  UI-001 (EditorLayoutMode enum)
    â””â”€â”€ UI-002 (TabBarView)
          â””â”€â”€ UI-003 (ContentView refactor) â† Foundation complete
                â”œâ”€â”€ UI-004 (Keyboard shortcuts)
                â”œâ”€â”€ UI-005 (Preview updates)
                â”œâ”€â”€ UI-006 (Line numbers)
                â”‚     â””â”€â”€ UI-018 (Preferences)
                â”œâ”€â”€ UI-007 (Current line highlight)
                â”‚     â””â”€â”€ UI-018 (Preferences)
                â”œâ”€â”€ UI-008 (Status bar)
                â”œâ”€â”€ UI-009 (Toolbar redesign)
                â”œâ”€â”€ UI-010 (Breadcrumbs)
                â”œâ”€â”€ UI-011 (Quick Open)
                â”œâ”€â”€ UI-012 (File status indicators)
                â”œâ”€â”€ UI-013 (Inspector infrastructure)
                â”‚     â””â”€â”€ UI-014 (Frontmatter in inspector)
                â”‚           â””â”€â”€ UI-015 (Preference for location)
                â”œâ”€â”€ UI-016 (Focus Mode)
                â”œâ”€â”€ UI-017 (Context menus)
                â”œâ”€â”€ UI-019 (Empty states)
                â””â”€â”€ UI-020 (Animations)
